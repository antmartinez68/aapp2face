{"config":{"lang":["es"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"\ud83c\udfdb\ufe0f AAPP2FACe","text":"<p>AAPP2FACe es una librer\u00eda Python para interactuar con los servicios web de FACe, el Punto General de Entrada de Facturas de la Administraci\u00f3n General del Estado, desde el lado de las Administraciones P\u00fablicas Espa\u00f1olas.</p> <p>Est\u00e1 dise\u00f1ada para ser f\u00e1cil de usar por desarrolladores y dispone de una interfaz de l\u00ednea de comandos (CLI) que tambi\u00e9n le permite ser usada por usuarios finales.</p> <p>Documentaci\u00f3n: https://antmartinez68.github.io/aapp2face</p> <p>C\u00f3digo fuente: https://github.com/antmartinez68/aapp2face</p>"},{"location":"#requisitos","title":"Requisitos","text":"<ul> <li>Python v3.10</li> </ul>"},{"location":"#instalacion","title":"Instalaci\u00f3n","text":""},{"location":"#como-libreria","title":"Como librer\u00eda","text":"<p>Aunque depende de c\u00f3mo est\u00e9s gestionando las dependencias de tu proyecto, por lo general querr\u00e1s hacer:</p> <pre><code>$ pip install aapp2face\n</code></pre>"},{"location":"#como-aplicacion-de-linea-de-comandos-cli","title":"Como aplicaci\u00f3n de l\u00ednea de comandos (CLI)","text":"<p>Si solo pretendes usar la interfaz de l\u00ednea de comandos, es recomendable instalar AAPP2FACe usando pipx:</p> <pre><code>$ pipx install aapp2face\n</code></pre>"},{"location":"#uso-basico","title":"Uso b\u00e1sico","text":""},{"location":"#como-libreria_1","title":"Como librer\u00eda","text":"<p>El siguiente script de ejemplo muestra c\u00f3mo puedes crear los objetos necesarios para conectar con FACe y recuperar la informaci\u00f3n de las nuevas facturas que est\u00e1n disponibles para su descarga:</p> <pre><code>&gt;&gt;&gt; from aapp2face import FACeConnection, FACeSoapClient\n&gt;&gt;&gt; cliente = FACeSoapClient(\n...     \"https://se-face-webservice.redsara.es/facturasrcf2?wsdl\",\n...     \"cert.pem\",\n...     \"key.pem\"\n... )\n&gt;&gt;&gt; face = FACeConnection(cliente)\n&gt;&gt;&gt; nuevas_facturas = face.solicitar_nuevas_facturas()\n&gt;&gt;&gt; for factura in nuevas_facturas:\n...\u00a0 \u00a0 print(\n...\u00a0 \u00a0 \u00a0 \u00a0 factura.numero_registro,\n...\u00a0 \u00a0 \u00a0 \u00a0 factura.fecha_hora_registro,\n...\u00a0 \u00a0 \u00a0 \u00a0 factura.oficina_contable,\n...\u00a0 \u00a0 \u00a0 \u00a0 factura.organo_gestor,\n...\u00a0 \u00a0 \u00a0 \u00a0 factura.unidad_tramitadora,\n...\u00a0 \u00a0 )\n...\n</code></pre>"},{"location":"#como-aplicacion-de-linea-de-comandos-cli_1","title":"Como aplicaci\u00f3n de l\u00ednea de comandos (CLI)","text":"<p>La misma operaci\u00f3n anterior puedes hacerla usando la CLI. Una vez tienes configurada la aplicaci\u00f3n, basta con que ejecutes el siguiente comando:</p> <pre><code>$ aapp2face facturas nuevas\n\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;N\u00famero registro:&lt;/b&gt;&lt;/span&gt;    &lt;span style=\"color:#A6E22E\"&gt;&lt;b&gt;202001015624&lt;/b&gt;&lt;/span&gt;\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;Fecha registro:&lt;/b&gt;&lt;/span&gt;     2023-01-19 10:57:38\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;Oficina contable:&lt;/b&gt;&lt;/span&gt;   P00000010\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;\u00d3rgano gestor:&lt;/b&gt;&lt;/span&gt;      P00000010\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;Unidad tramitadora:&lt;/b&gt;&lt;/span&gt; P00000010\n\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;N\u00famero registro:&lt;/b&gt;&lt;/span&gt;    &lt;span style=\"color:#A6E22E\"&gt;&lt;b&gt;202001017112&lt;/b&gt;&lt;/span&gt;\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;Fecha registro:&lt;/b&gt;&lt;/span&gt;     2013-01-20 11:05:51\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;Oficina contable:&lt;/b&gt;&lt;/span&gt;   P00000010\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;\u00d3rgano gestor:&lt;/b&gt;&lt;/span&gt;      P00000010\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;Unidad tramitadora:&lt;/b&gt;&lt;/span&gt; P00000010\n\n&lt;span style=\"color:#A6E22E\"&gt;&lt;b&gt;2&lt;/b&gt;&lt;/span&gt; nuevas facturas disponibles\n</code></pre>"},{"location":"#constuir-aapp2face-desde-codigo-fuente","title":"Constuir AAPP2FACe desde c\u00f3digo fuente","text":"<p>AAPP2FACe usa Poetry como gestor de dependencias y empaquetado. Si quieres construirlo desde el c\u00f3digo fuente, puede hacerlo mediante:</p> <pre><code>$ git clone https://github.com/antmartinez68/aapp2face\n$ cd aapp2face\n$ poetry install\n$ poetry run pytest\n$ poetry build\n</code></pre>"},{"location":"#encuesta-de-uso","title":"Encuesta de uso","text":"<p>Para poder entender mejor qui\u00e9nes y c\u00f3mo est\u00e1n utilizando esta librer\u00eda, mejorarla y asegurar que se est\u00e1n satisfaciendo las necesidades de sus usuarios, hemos preparado una breve encuesta. Conocer m\u00e1s sobre su uso resulta fundamental para continuar su desarrollo y mejora.</p> <p>Si deseas contribuir de esta forma, te invitamos a responder la encuesta en el siguiente enlace: https://forms.gle/VVX3qnJFAJeuB4Jj7</p> <p>Gracias por tu inter\u00e9s en este proyecto de software libre.</p>"},{"location":"changelog/","title":"Changelog","text":""},{"location":"changelog/#101-15-febrero-2025","title":"1.0.1 (15 Febrero 2025)","text":""},{"location":"changelog/#correcciones","title":"Correcciones","text":"<ul> <li>Corrige error al cambiar el estado de un listado de facturas que afectaba   tanto a librer\u00eda como a interfaz de l\u00ednea de comandos.</li> </ul>"},{"location":"changelog/#100-22-marzo-2023","title":"1.0.0 (22 Marzo 2023)","text":"<ul> <li>Versi\u00f3n inicial del proyecto.</li> </ul>"},{"location":"glossary/","title":"Glosario","text":"<p>A continuaci\u00f3n se recogen, a modo de recordatorio, algunos de los t\u00e9rminos usados con frecuencia en esta documentaci\u00f3n y que hacen referencia a conceptos usados en la gesti\u00f3n y tramitaci\u00f3n de facturas electr\u00f3nicas a trav\u00e9s de FACe.</p> <ul> <li> <p>DIR3: Directorio que proporciona un inventario unificado y com\u00fan a   toda la Administraci\u00f3n de las unidades org\u00e1nicas / organismos   p\u00fablicos, sus oficinas asociadas y unidades de gesti\u00f3n econ\u00f3mica o   presupuestaria. As\u00ed, el c\u00f3digo DIR3 identifica a la adminstraci\u00f3n   correspondiente.</p> </li> <li> <p>Numero de registro: Identificador \u00fanico de una factura dentro de la   plataforma FACe.</p> </li> <li> <p>Oficina Contable (OC): Es la unidad o unidades que tienen atribuida la   funci\u00f3n de contabilidad en el Organismo y que tambi\u00e9n son competentes   para la gesti\u00f3n del Registro Contable de Facturas.</p> </li> <li> <p>\u00d3rgano Gestor (OG): Centro directivo, delegaci\u00f3n, subdelegaci\u00f3n   territorial u organismo de la Administraci\u00f3n General del Estado,   Comunidad Aut\u00f3noma o Entidad Local a que corresponda la competencia   sobre la aprobaci\u00f3n del expediente de gasto.</p> </li> <li> <p>RCF (Registro Contable de Facturas): Registro contable del Organismo   destinatario de las facturas.</p> </li> <li> <p>REC (Registro Electr\u00f3nico Com\u00fan): Registro general de facturas de la   plataforma FACe.</p> </li> <li> <p>Relaci\u00f3n: Conjunto formado por \u00d3rgano Gestor, Oficina Contable y   Unidad Tramitadora (OG-OC-UT) que identifica el destino de una   factura, generalmente mediante los c\u00f3digos DIR3.</p> </li> <li> <p>Unidad Tramitadora (UT): \u00d3rgano administrativo al que corresponda la   tramitaci\u00f3n de los expedientes, sin perjuicio de a quien competa su   aprobaci\u00f3n.</p> </li> </ul>"},{"location":"cli/comandos/","title":"Manual de referencia","text":"<p>Interfaz de l\u00ednea de comandos AAPP2FACe</p> <p>Uso:</p> <pre><code>$ aapp2face [OPCIONES] COMANDO [ARGUMENTOS]...\n</code></pre> <p>Opciones:</p> <ul> <li><code>-c, --config PATH</code>: Permite indicar un archivo de configuraci\u00f3n alternativo.</li> <li><code>--url-prod TEXT</code>: URL de ubicaci\u00f3n del WSDL para el entorno de producci\u00f3n de FACe.</li> <li><code>--url-staging TEXT</code>: URL de ubicaci\u00f3n del WSDL para el entorno de pruebas de FACe.</li> <li><code>-u, --use-staging / -U, --use-prod</code>: Fuerza el uso del entorno de pruebas en la peticiones a FACe.</li> <li><code>--cert-file FILE</code>: Archivo que contiene el certificado para firma peticiones.</li> <li><code>--key-file FILE</code>: Archivo que contiene la clave privada del certificado.</li> <li><code>-d, --download-dir PATH</code>: Ruta donde se alojar\u00e1n los archivos descargados.</li> <li><code>--version</code>: Muestra la versi\u00f3n de la aplicaci\u00f3n y sale.</li> <li><code>--install-completion</code>: Instala autocompletado para el shell actual.</li> <li><code>--show-completion</code>: Muestra autocompletado para el shell actual, para copiar o personalizar la instalaci\u00f3n.</li> <li><code>--help</code>: Muestra la ayuda y sale.</li> </ul> <p>Comandos:</p> <ul> <li><code>anulaciones</code>: Gesti\u00f3n de solicitudes de anulaci\u00f3n.</li> <li><code>cesiones</code>: Gesti\u00f3n de las cesiones de cr\u00e9dito.</li> <li><code>config</code>: Muestra los valores de configuraci\u00f3n que est\u00e1n siendo aplicados.</li> <li><code>estados</code>: Lista los estados que maneja FACe para la gesti\u00f3n de las facturas.</li> <li><code>facturas</code>: Gesti\u00f3n de facturas.</li> <li><code>init</code>: Genera un archivo de configuraci\u00f3n nuevo mediante asistente.</li> <li><code>unidades</code>: Lista las relaciones OG-UT-OC asociadas al RCF.</li> </ul>"},{"location":"cli/comandos/#aapp2face-anulaciones","title":"<code>aapp2face anulaciones</code>","text":"<p>Gesti\u00f3n de solicitudes de anulaci\u00f3n.</p> <p>Uso:</p> <pre><code>$ aapp2face anulaciones [OPCIONES] COMANDO [ARGUMENTOS]...\n</code></pre> <p>Opciones:</p> <ul> <li><code>--help</code>: Muestra la ayuda y sale.</li> </ul> <p>Comandos:</p> <ul> <li><code>gestionar</code>: Gestiona las solicitudes de anulaci\u00f3n de...</li> <li><code>nuevas</code>: Devuelve las facturas que se encuentran en...</li> </ul>"},{"location":"cli/comandos/#aapp2face-anulaciones-gestionar","title":"<code>aapp2face anulaciones gestionar</code>","text":"<p>Gestiona las solicitudes de anulaci\u00f3n de facturas.</p> <p>Si se indican varias facturas, todas ellas deben pertenecer a la misma Oficina Contable. El nuevo estado y comentario facilitados ser\u00e1n asignados a todas las facturas indicadas. Obs\u00e9rvese que el par\u00e1metro comentario es obligatorio. Si se desea dejar en blanco se de indicar expl\u00edcitamente, por ejemplo, usando comillas (\"\").</p> <p>Uso:</p> <pre><code>$ aapp2face anulaciones gestionar [OPCIONES] OFICINA_CONTABLE CODIGO COMENTARIO NUMEROS_REGISTRO...\n</code></pre> <p>Argumentos:</p> <ul> <li><code>OFICINA_CONTABLE</code>: C\u00f3digo DIR3 de la Oficina Contable.  [required]</li> <li><code>CODIGO</code>: Identificador del estado a asignar.  [required]</li> <li><code>COMENTARIO</code>: Comentario asociado al cambio de estado.  [required]</li> <li><code>NUMEROS_REGISTRO...</code>: N\u00fameros de registro de las facturas con solicitud de anulaci\u00f3n.  [required]</li> </ul> <p>Opciones:</p> <ul> <li><code>--help</code>: Muestra la ayuda y sale.</li> </ul>"},{"location":"cli/comandos/#aapp2face-anulaciones-nuevas","title":"<code>aapp2face anulaciones nuevas</code>","text":"<p>Devuelve las facturas que se encuentran en estado \"solicitada anulaci\u00f3n\".</p> <p>Si no se pasa el c\u00f3digo de la Oficina Contable, retornar\u00e1 todas las facturas en este estado del RCF.</p> <p>El RCF deber\u00e1 solicitar peri\u00f3dicamente este servicio para conocer las solicitudes de anulaci\u00f3n de facturas recibidas en FACe por parte de los proveedores.</p> <p>El resultado est\u00e1 limitado a un m\u00e1ximo de 500 facturas. Las solicitudes deben ser procesadas para que entren el resto de solicitudes encoladas.</p> <p>Uso:</p> <pre><code>$ aapp2face anulaciones nuevas [OPCIONES] [OFICINA_CONTABLE]\n</code></pre> <p>Argumentos:</p> <ul> <li><code>[OFICINA_CONTABLE]</code>: C\u00f3digo DIR3 de la Oficina Contable.</li> </ul> <p>Opciones:</p> <ul> <li><code>-e, --export PATH</code>: Exporta la salida a un archivo CSV.</li> <li><code>--help</code>: Muestra la ayuda y sale.</li> </ul>"},{"location":"cli/comandos/#aapp2face-cesiones","title":"<code>aapp2face cesiones</code>","text":"<p>Gesti\u00f3n de las cesiones de cr\u00e9dito.</p> <p>Uso:</p> <pre><code>$ aapp2face cesiones [OPCIONES] COMANDO [ARGUMENTOS]...\n</code></pre> <p>Opciones:</p> <ul> <li><code>--help</code>: Muestra la ayuda y sale.</li> </ul> <p>Comandos:</p> <ul> <li><code>consultar</code>: Consulta el estado de la cesi\u00f3n de una...</li> <li><code>documento</code>: Obtiene el documento de la cesi\u00f3n.</li> <li><code>gestionar</code>: Gestiona la cesi\u00f3n de cr\u00e9dito de una factura.</li> </ul>"},{"location":"cli/comandos/#aapp2face-cesiones-consultar","title":"<code>aapp2face cesiones consultar</code>","text":"<p>Consulta el estado de la cesi\u00f3n de una factura.</p> <p>Consulta el estado de la cesi\u00f3n de una factura cuyo identificador es facilitado.</p> <p>Uso:</p> <pre><code>$ aapp2face cesiones consultar [OPCIONES] NUMERO_REGISTRO\n</code></pre> <p>Argumentos:</p> <ul> <li><code>NUMERO_REGISTRO</code>: N\u00famero de registro de la facturas a consultar.  [required]</li> </ul> <p>Opciones:</p> <ul> <li><code>--help</code>: Muestra la ayuda y sale.</li> </ul>"},{"location":"cli/comandos/#aapp2face-cesiones-documento","title":"<code>aapp2face cesiones documento</code>","text":"<p>Obtiene el documento de la cesi\u00f3n.</p> <p>Obtiene el documento de la cesi\u00f3n conectando al servicio de notarios.</p> <p>Uso:</p> <pre><code>$ aapp2face cesiones documento [OPCIONES] CSV REPOSITORIO NIF NOMBRE APELLIDOS\n</code></pre> <p>Argumentos:</p> <ul> <li><code>CSV</code>: CSV del documento a obtener.  [required]</li> <li><code>REPOSITORIO</code>: Repositorio desde el que se obtiene el documento.  [required]</li> <li><code>NIF</code>: NIF del solicitante.  [required]</li> <li><code>NOMBRE</code>: Nombre del solicitante.  [required]</li> <li><code>APELLIDOS</code>: Apellidos del solicitante.  [required]</li> </ul> <p>Opciones:</p> <ul> <li><code>-f, --force</code>: Sobrescribe los archivos de factura o anexos si existen.</li> <li><code>--help</code>: Muestra la ayuda y sale.</li> </ul>"},{"location":"cli/comandos/#aapp2face-cesiones-gestionar","title":"<code>aapp2face cesiones gestionar</code>","text":"<p>Gestiona la cesi\u00f3n de cr\u00e9dito de una factura.</p> <p>Obs\u00e9rvese que el par\u00e1metro comentario es obligatorio. Si se desea dejar en blanco se de indicar expl\u00edcitamente, por ejemplo, usando comillas (\"\").</p> <p>Uso:</p> <pre><code>$ aapp2face cesiones gestionar [OPCIONES] CODIGO COMENTARIO NUMERO_REGISTRO\n</code></pre> <p>Argumentos:</p> <ul> <li><code>CODIGO</code>: Identificador del estado a asignar.  [required]</li> <li><code>COMENTARIO</code>: Comentario asociado al cambio de estado.  [required]</li> <li><code>NUMERO_REGISTRO</code>: N\u00fameros de registro de la factura de la cesi\u00f3n.  [required]</li> </ul> <p>Opciones:</p> <ul> <li><code>--help</code>: Muestra la ayuda y sale.</li> </ul>"},{"location":"cli/comandos/#aapp2face-config","title":"<code>aapp2face config</code>","text":"<p>Muestra los valores de configuraci\u00f3n que est\u00e1n siendo aplicados.</p> <p>Uso:</p> <pre><code>$ aapp2face config [OPCIONES]\n</code></pre> <p>Opciones:</p> <ul> <li><code>--help</code>: Muestra la ayuda y sale.</li> </ul>"},{"location":"cli/comandos/#aapp2face-estados","title":"<code>aapp2face estados</code>","text":"<p>Lista los estados que maneja FACe para la gesti\u00f3n de las facturas.</p> <p>Existen dos flujos principales, el ordinario y el de anulaci\u00f3n. El flujo ordinario corresponde al ciclo de vida de la factura, y el flujo de anulaci\u00f3n corresponde al ciclo de solicitud de anulaci\u00f3n.</p> <p>Uso:</p> <pre><code>$ aapp2face estados [OPCIONES]\n</code></pre> <p>Opciones:</p> <ul> <li><code>-e, --export PATH</code>: Exporta la salida a un archivo CSV.</li> <li><code>--help</code>: Muestra la ayuda y sale.</li> </ul>"},{"location":"cli/comandos/#aapp2face-facturas","title":"<code>aapp2face facturas</code>","text":"<p>Gesti\u00f3n de facturas.</p> <p>Uso:</p> <pre><code>$ aapp2face facturas [OPCIONES] COMANDO [ARGUMENTOS]...\n</code></pre> <p>Opciones:</p> <ul> <li><code>--help</code>: Muestra la ayuda y sale.</li> </ul> <p>Comandos:</p> <ul> <li><code>confirmar</code>: Confirma la descarga de una factura.</li> <li><code>consultar</code>: Consulta el estado de facturas.</li> <li><code>crcf</code>: Cambia el c\u00f3digo RCF asginado a una factura.</li> <li><code>descargar</code>: Descarga facturas.</li> <li><code>estado</code>: Cambia el estado de las facturas.</li> <li><code>nuevas</code>: Devuelve las nuevas facturas registradas...</li> <li><code>rcf</code>: Consulta el c\u00f3digo RCF de una factura.</li> </ul>"},{"location":"cli/comandos/#aapp2face-facturas-confirmar","title":"<code>aapp2face facturas confirmar</code>","text":"<p>Confirma la descarga de una factura.</p> <p>Tras la descarga de una factura debe utilizarse este comando para confirmar que el proceso de descarga se ha realizado con \u00e9xito, de forma que la plataforma FACe pueda realizar todas las acciones relacionadas con la descarga de la factura por parte del RCF.</p> <p>Tras confirmar la descarga de una factura, su estado queda actualizado autom\u00e1ticamente a 1300.</p> <p>Uso:</p> <pre><code>$ aapp2face facturas confirmar [OPCIONES] OFICINA_CONTABLE NUMERO_REGISTRO CODIGO_RCF\n</code></pre> <p>Argumentos:</p> <ul> <li><code>OFICINA_CONTABLE</code>: C\u00f3digo DIR3 de la Oficina Contable.  [required]</li> <li><code>NUMERO_REGISTRO</code>: N\u00famero de registro de la factura a confirmar.  [required]</li> <li><code>CODIGO_RCF</code>: C\u00f3digo RCF que se asignar\u00e1 a la factura.  [required]</li> </ul> <p>Opciones:</p> <ul> <li><code>--help</code>: Muestra la ayuda y sale.</li> </ul>"},{"location":"cli/comandos/#aapp2face-facturas-consultar","title":"<code>aapp2face facturas consultar</code>","text":"<p>Consulta el estado de facturas.</p> <p>Consulta el estado de las facturas cuyos identificadores son facilitados.</p> <p>Uso:</p> <pre><code>$ aapp2face facturas consultar [OPCIONES] NUMEROS_REGISTRO...\n</code></pre> <p>Argumentos:</p> <ul> <li><code>NUMEROS_REGISTRO...</code>: N\u00fameros de registro de las facturas a consultar.  [required]</li> </ul> <p>Opciones:</p> <ul> <li><code>-e, --export PATH</code>: Exporta la salida a un archivo CSV.</li> <li><code>--help</code>: Muestra la ayuda y sale.</li> </ul>"},{"location":"cli/comandos/#aapp2face-facturas-crcf","title":"<code>aapp2face facturas crcf</code>","text":"<p>Cambia el c\u00f3digo RCF asginado a una factura.</p> <p>Asigna el c\u00f3digo RCF facilitado a la factura con el n\u00famero de registro indicado.</p> <p>Uso:</p> <pre><code>$ aapp2face facturas crcf [OPCIONES] NUMERO_REGISTRO CODIGO_RCF\n</code></pre> <p>Argumentos:</p> <ul> <li><code>NUMERO_REGISTRO</code>: N\u00famero de registro de la factura a actualizar.  [required]</li> <li><code>CODIGO_RCF</code>: C\u00f3digo RCF que se asignar\u00e1 a la factura.  [required]</li> </ul> <p>Opciones:</p> <ul> <li><code>--help</code>: Muestra la ayuda y sale.</li> </ul>"},{"location":"cli/comandos/#aapp2face-facturas-descargar","title":"<code>aapp2face facturas descargar</code>","text":"<p>Descarga facturas.</p> <p>Descarga las facturas correspondientes a los indentificadores facilitados. Si no se facilita ninguno se descargar\u00e1n todas las facturas nuevas del RCF.</p> <p>En el directorio destino determinado por la configuraci\u00f3n ser\u00e1 creado un nuevo directorio por cada fatura usando como nombre el n\u00famero de registro de esta y en \u00e9l se descargar\u00e1n tanto el archivo de la factura como los archivos de los correspondientes anexos si los tuviera.</p> <p>Uso:</p> <pre><code>$ aapp2face facturas descargar [OPCIONES] [NUMEROS_REGISTRO]...\n</code></pre> <p>Argumentos:</p> <ul> <li><code>[NUMEROS_REGISTRO]...</code>: N\u00fameros de registro de las facturas a descargar.</li> </ul> <p>Opciones:</p> <ul> <li><code>-f, --force</code>: Sobrescribe los archivos de factura o anexos si existen.</li> <li><code>-e, --export PATH</code>: Exporta la salida a un archivo CSV.</li> <li><code>--help</code>: Muestra la ayuda y sale.</li> </ul>"},{"location":"cli/comandos/#aapp2face-facturas-estado","title":"<code>aapp2face facturas estado</code>","text":"<p>Cambia el estado de las facturas.</p> <p>Si se indican varias facturas, todas ellas deben pertenecer a la misma Oficina Contable. El nuevo estado y comentario facilitados ser\u00e1n asignados a todas las facturas indicadas. Obs\u00e9rvese que el par\u00e1metro comentario es obligatorio. Si se desea dejar en blanco se de indicar expl\u00edcitamente, por ejemplo, usando comillas (\"\").</p> <p>Los estados 1300 y 3100 no pueden ser asignados mediante este comando ya que estos estados son asignados de forma autom\u00e1tica al realizar las operaciones de confirmaci\u00f3n de descarga de una factura y gesti\u00f3n de la solicitud de anulaci\u00f3n respectivamente. El estado inicial 1200 tampoco es gestionable mediante este comando.</p> <p>Uso:</p> <pre><code>$ aapp2face facturas estado [OPCIONES] OFICINA_CONTABLE CODIGO COMENTARIO NUMEROS_REGISTRO...\n</code></pre> <p>Argumentos:</p> <ul> <li><code>OFICINA_CONTABLE</code>: C\u00f3digo DIR3 de la Oficina Contable.  [required]</li> <li><code>CODIGO</code>: Identificador del estado a asignar.  [required]</li> <li><code>COMENTARIO</code>: Comentario asociado al cambio de estado.  [required]</li> <li><code>NUMEROS_REGISTRO...</code>: N\u00fameros de registro de las facturas a cambiar estado.  [required]</li> </ul> <p>Opciones:</p> <ul> <li><code>--help</code>: Muestra la ayuda y sale.</li> </ul>"},{"location":"cli/comandos/#aapp2face-facturas-nuevas","title":"<code>aapp2face facturas nuevas</code>","text":"<p>Devuelve las nuevas facturas registradas en FACe.</p> <p>Consulta las facturas que se encuentran en el estado \"registrada\". Peri\u00f3dicamente se deber\u00e1 utilizar este comando para obtener las facturas que posteriormente deber\u00e1n ser recuperadas.</p> <p>El resultado est\u00e1 limitado por el servicio de FACe a un m\u00e1ximo de 500 facturas. Se deben procesar las facturas para que entren el resto de facturas encoladas.</p> <p>Uso:</p> <pre><code>$ aapp2face facturas nuevas [OPCIONES] [OFICINA_CONTABLE]\n</code></pre> <p>Argumentos:</p> <ul> <li><code>[OFICINA_CONTABLE]</code>: C\u00f3digo DIR3 de la Oficina Contable.</li> </ul> <p>Opciones:</p> <ul> <li><code>-e, --export PATH</code>: Exporta la salida a un archivo CSV.</li> <li><code>--help</code>: Muestra la ayuda y sale.</li> </ul>"},{"location":"cli/comandos/#aapp2face-facturas-rcf","title":"<code>aapp2face facturas rcf</code>","text":"<p>Consulta el c\u00f3digo RCF de una factura.</p> <p>Consulta el c\u00f3digo RCF asignado a una factura cuyo indentificador es facilitado.</p> <p>Uso:</p> <pre><code>$ aapp2face facturas rcf [OPCIONES] NUMERO_REGISTRO\n</code></pre> <p>Argumentos:</p> <ul> <li><code>NUMERO_REGISTRO</code>: N\u00famero de registro de la facturas a consultar.  [required]</li> </ul> <p>Opciones:</p> <ul> <li><code>--help</code>: Muestra la ayuda y sale.</li> </ul>"},{"location":"cli/comandos/#aapp2face-init","title":"<code>aapp2face init</code>","text":"<p>Genera un archivo de configuraci\u00f3n nuevo mediante asistente.</p> <p>Uso:</p> <pre><code>$ aapp2face init [OPCIONES]\n</code></pre> <p>Opciones:</p> <ul> <li><code>--help</code>: Muestra la ayuda y sale.</li> </ul>"},{"location":"cli/comandos/#aapp2face-unidades","title":"<code>aapp2face unidades</code>","text":"<p>Lista las relaciones OG-UT-OC asociadas al RCF.</p> <p>Las relaciones OG-UT-OC obtenidas son las asociadas al RCF que firma la petici\u00f3n.</p> <p>Uso:</p> <pre><code>$ aapp2face unidades [OPCIONES]\n</code></pre> <p>Opciones:</p> <ul> <li><code>-e, --export PATH</code>: Exporta la salida a un archivo CSV.</li> <li><code>--help</code>: Muestra la ayuda y sale.</li> </ul>"},{"location":"cli/tutorial/cambiar-estado-facturas/","title":"Cambiar estado facturas","text":"<p>Con la tramitaci\u00f3n de una factura en la unidad correspondiente, est\u00e1 transitar\u00e1 por diferentes estados que deben ser comunicados a FACe para que esta informaci\u00f3n est\u00e9 disponible para los proveedores.</p> <p>Cada vez que una factura cambie de estado puedes usar el comando <code>aapp2face facturas estado</code> para comunicar este cambio a FACe.</p> <p>Para el siguiente ejemplo, imagina que la factura con n\u00famero de registro 202001020718, correspondiente a la oficina contable P00000010, ha llegado al final de su tramitaci\u00f3n y se ha cursado el pago al proveedor. Este cambio lo notificaremos a FACe indicando el estado \"Pagada\" (2500). As\u00ed mismo, es posible facilitar un comentario asociado al cambio de estado, en el ejemplo, \"Orden de pago ejecutada\".</p> <pre><code>$ aapp2face facturas estado P00000010 2500 \"Orden de pago ejecutada\" 202001020718\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;N\u00famero de registro:&lt;/b&gt;&lt;/span&gt; &lt;span style=\"color:#A6E22E\"&gt;&lt;b&gt;202001020718&lt;/b&gt;&lt;/span&gt;\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;C\u00f3digo de estado:&lt;/b&gt;&lt;/span&gt;   2500\n</code></pre>"},{"location":"cli/tutorial/configuracion/","title":"Configuraci\u00f3n inicial","text":"<p>El primer paso recomendado es la configuraci\u00f3n de la interfaz de l\u00ednea de comandos para interactuar con FACe. De esta forma evitar\u00e1s tener que suministrar los par\u00e1metros de configuraci\u00f3n cada vez que invoques un comando.</p> <p>Puedes crear manualmente el archivo de configuraci\u00f3n o usar el comando <code>init</code> para lanzar un asistente que te ayudar\u00e1 en el proceso.</p>"},{"location":"cli/tutorial/configuracion/#configuracion-manual","title":"Configuraci\u00f3n manual","text":"<p>Para configurar manualmente la interfaz de l\u00ednea de comandos de AAPP2FACe debes crear un archivo de texto llamado <code>config.ini</code> en la siguiente ubicaci\u00f3n, dependiendo de tu sistema operativo:</p> <ul> <li>Linux: <code>~/.config/aapp2face</code></li> <li>macOS: <code>~/Library/Application Support/aapp2face</code></li> <li>Windows: <code>C:/Users/&lt;USER&gt;/AppData/Roaming/aapp2face</code></li> </ul> <p>El archivo debe tener la siguiente estructura:</p> <pre><code>[FACe]\nurl_prod = https://webservice.face.gob.es/facturasrcf2?wsdl\nurl_staging = https://se-face-webservice.redsara.es/facturasrcf2?wsdl\nuse_staging = True\n\n[X509]\ncert_file = /home/usuario/face/credenciales/cert.pem\nkey_file = /home/usuario/face/credenciales/key.pem\n\n[App]\ndownload_dir = /home/usuario/face/descargas\n\n[Debug]\nenabled = False\nlog_dir = /home/usuario/face/logs\n</code></pre> <p>En la secci\u00f3n <code>[FACe]</code> puedes encontrar los siguientes valores:</p> <ul> <li> <p><code>url_prod</code>: Es la URL del WSDL de FACe para el entorno de producci\u00f3n   usando codificaci\u00f3n RCP-Literal.</p> </li> <li> <p><code>url_staging</code>: Es la URL del WSDL de FACe para el entorno de pruebas   usando codificaci\u00f3n RCP-Literal.</p> </li> <li> <p><code>use_staging</code>: Si es <code>True</code> la peticiones ser\u00e1n enviadas al entorno de   pruebas. Este es el valor por defecto. Cuando est\u00e9s preparado para   usar el entorno de producci\u00f3n, deber\u00e1s establecer este valor a   <code>False</code>.</p> </li> </ul> <p>En la secci\u00f3n <code>[X509]</code> puedes encontrar los siguientes valores:</p> <ul> <li> <p><code>cert_file</code>: Es la ruta que apunta al certificado digital que ser\u00e1   usado para firmar las peticiones a FACe. La clave p\u00fablica de este   certificado tiene que haber sido comunicada a FACe previamente para su   autorizaci\u00f3n.</p> </li> <li> <p><code>key_file</code>: Es la ruta que apunta a la clave privada del certificado   anterior y que permite realizar la firma de las peticiones. La clave   privada no debe tener contrase\u00f1a para facilitar un uso \u00e1gil desde la   terminal o en scripts de automatizaci\u00f3n de tareas. Por tanto, debes   proveer al archivo de alg\u00fan sistema de protecci\u00f3n a nivel de sistema   operativo.</p> </li> </ul> <p>En la secci\u00f3n <code>[App]</code> puedes encontrar los siguientes valores:</p> <ul> <li><code>download_dir</code>: Es la ruta donde ser\u00e1n descargados los archivos XSIG   de las facturas y otros archivos anexos que pudieran contener.</li> </ul> <p>En la secci\u00f3n <code>[Debug]</code> puedes encontrar los siguientes valores:</p> <ul> <li> <p><code>enabled</code>: Permite activar el modo depuraci\u00f3n. Su valor por defecto es   <code>False</code> (desactivado). Si se activa con <code>True</code>, las peticiones y   respuestas SOAP, as\u00ed como las estructuras de datos enviadas y   recibidas, ser\u00e1n guardas en la ruta indicada con el par\u00e1metro   <code>log_dir</code>.</p> </li> <li> <p><code>log_dir</code>: Indica la ruta donde ser\u00e1n guardados los archivos de   registro generados teniendo activo el modo depuraci\u00f3n.</p> </li> </ul>"},{"location":"cli/tutorial/configuracion/#configuracion-asistida","title":"Configuraci\u00f3n asistida","text":"<p>Si usas el comando <code>init</code>, el programa crear\u00e1 el archivo de configuraci\u00f3n por ti. Solo tienes que responder a una serie de preguntas confirmando los valores por defecto o usando los valores personalizados adaptados a tus necesidades:</p> <pre><code>$ aapp2face init\nURL Producci\u00f3n FACe [https://webservice.face.gob.es/facturasrcf2?wsdl]: \u21a9\nURL Staging FACe [https://se-face-webservice.redsara.es/facturasrcf2?wsdl]: \u21a9\n\u00bfUsar entorno de pruebas por defecto? [S/n]: \u21a9\nArchivo con el certificado de firma [./cert.pem]: &lt;b&gt;~/face/cert.pem&lt;/b&gt;\nArchivo con la clave privada del certificado [./key.pem]: &lt;b&gt;~/face/key.pem&lt;/b&gt;\nDirectorio descarga facturas [./descargas]: &lt;b&gt;~/face/descargas&lt;/b&gt;\n&lt;span style=\"color:#A6E22E\"&gt;Archivo de configuraci\u00f3n generado!!&lt;/span&gt;\n</code></pre>"},{"location":"cli/tutorial/confirmar-facturas/","title":"Confirmar facturas","text":"<p>Una vez que has realizado la descarga de las facturas y has verificado que esta se ha realizado correctamente, es necesario comunicarlo a FACe para que la plataforma realice las operaciones correspondientes. La confirmaci\u00f3n de la descarga de una factura procar\u00e1 que FACe cambie su estado de forma autom\u00e1tica, pasando del estado \"Registrada\" (1200) a \"Registrada en RCF\" (1300). Adem\u00e1s, una vez confirmada una factura, esta dejar\u00e1 de estar disponible para descarga.</p> <p>Para confirmar la descarga debes invocar el comando <code>aapp2face facturas confirmar</code> por cada una de las facturas. Con este comando debes facilitar como argumentos el c\u00f3digo DIR3 de la oficina contable, el n\u00famero de registro de la factura y el c\u00f3digo asignado a la factura en el RCF tras el proceso administrativo correspondiente.</p> <p>A continuaci\u00f3n usaremos un ejemplo de confirmaci\u00f3n de la factura con n\u00famero de registro 202001020718, correspondiente a la oficina contable P00000010 e indicaremos que le ha sido asignado, en el RCF, el n\u00famero de registro o c\u00f3digo RCF123. La respuesta devuelta por la plataforma nos confirma la identificaci\u00f3n de la factura y su cambio al estado \"Registrada en RCF\" (1300).</p> <pre><code>$ aapp2face facturas confirmar P00000010 202001020718 RCF123\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;Oficina contable:&lt;/b&gt;&lt;/span&gt;   P00000010\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;N\u00famero de registro:&lt;/b&gt;&lt;/span&gt; 202001020718\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;C\u00f3digo de estado:&lt;/b&gt;&lt;/span&gt;   1300\n</code></pre>"},{"location":"cli/tutorial/descargar-facturas/","title":"Descargar facturas","text":"<p>Con la consulta de las nuevas facturas registradas en la plataforma FACe, hemos obtenido sus n\u00fameros de registro. Ahora solo tienes que invocar al comando <code>aapp2face facturas descargar</code> seguido de los n\u00fameros de registro de las facturas que quieres descargar para que esta se inicie.</p> <p>En el directorio de descargas que hayas configurado se crear\u00e1, por cada factura, un directorio que tiene por nombre el n\u00famero de registro de la factura. Dentro de cada directorio, ser\u00e1n descargados los archivos XSIG de las facturas electr\u00f3nicas en formato Factuae y los anexos (por ejemplo, archivos PDF) que puedieran acompa\u00f1ar a estas.</p> <pre><code>$ aapp2face facturas descargar 2020FA00044914 2020FA00052749\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;N\u00fam. Registro:&lt;/b&gt;&lt;/span&gt; &lt;span style=\"color:#A6E22E\"&gt;&lt;b&gt;202001015624&lt;/b&gt;&lt;/span&gt;\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;N\u00fam. Factura:&lt;/b&gt;&lt;/span&gt;  2020FA00044914\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;Serie:&lt;/b&gt;&lt;/span&gt;         None\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;Importe:&lt;/b&gt;&lt;/span&gt;       39.87\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;Proveedor:&lt;/b&gt;&lt;/span&gt;     ESA88888888\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;Archivo:&lt;/b&gt;&lt;/span&gt;       AGE_2062644_000053.F20200521.xsig\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;Anexos:&lt;/b&gt;&lt;/span&gt;\n\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;N\u00fam. Registro:&lt;/b&gt;&lt;/span&gt; &lt;span style=\"color:#A6E22E\"&gt;&lt;b&gt;202001017112&lt;/b&gt;&lt;/span&gt;\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;N\u00fam. Factura:&lt;/b&gt;&lt;/span&gt;  2020FA00052749\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;Serie:&lt;/b&gt;&lt;/span&gt;         None\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;Importe:&lt;/b&gt;&lt;/span&gt;       2601.25\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;Proveedor:&lt;/b&gt;&lt;/span&gt;     ESA99999999\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;Archivo:&lt;/b&gt;&lt;/span&gt;       AGE_2064077_000182.F20200526.xsig\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;Anexos:&lt;/b&gt;&lt;/span&gt;\n\n&lt;span style=\"color:#A6E22E\"&gt;&lt;b&gt;2&lt;/b&gt;&lt;/span&gt; facturas descargadas\n</code></pre> <p>El siguiente paso es verificar las facturas y confirmar a FACe que el proceso se ha realizado correctamente. Hasta que no confirmes a FACe la descarga de las facturas, estas mantendr\u00e1n en la plataforma el estado \"Registrada\" (1200) y seguir\u00e1n disponibles para que realices nuevos intentos de descarga.</p> <p>Puedes comprobar el estado de las facturas haciendo uso del comando <code>aapp2face facturas consultar</code>. Con el siguiente ejemplo podr\u00e1s observar que, aunque se han descargado las facturas, estas mantienen el estado \"Registada\" (1200) en la plataforma.</p> <pre><code>$ aapp2face facturas consultar 2020FA00044914 2020FA00052749\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;N\u00famero registro:&lt;/b&gt;&lt;/span&gt; &lt;span style=\"color:#A6E22E\"&gt;&lt;b&gt;202001015624&lt;/b&gt;&lt;/span&gt;\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;Tramitaci\u00f3n:&lt;/b&gt;&lt;/span&gt;\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;  C\u00f3digo:&lt;/b&gt;&lt;/span&gt;        1200\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;  Descripci\u00f3n:&lt;/b&gt;&lt;/span&gt;   La factura ha sido registrada en el registro electr\u00f3nico REC\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;  Motivo:&lt;/b&gt;&lt;/span&gt;\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;Anulaci\u00f3n:&lt;/b&gt;&lt;/span&gt;\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;  C\u00f3digo:&lt;/b&gt;&lt;/span&gt;        4100\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;  Descripci\u00f3n:&lt;/b&gt;&lt;/span&gt;   No solicitada anulaci\u00f3n\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;  Motivo:&lt;/b&gt;&lt;/span&gt;\n\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;N\u00famero registro:&lt;/b&gt;&lt;/span&gt; &lt;span style=\"color:#A6E22E\"&gt;&lt;b&gt;202001017112&lt;/b&gt;&lt;/span&gt;\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;Tramitaci\u00f3n:&lt;/b&gt;&lt;/span&gt;\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;  C\u00f3digo:&lt;/b&gt;&lt;/span&gt;        1200\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;  Descripci\u00f3n:&lt;/b&gt;&lt;/span&gt;   La factura ha sido registrada en el registro electr\u00f3nico REC\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;  Motivo:&lt;/b&gt;&lt;/span&gt;\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;Anulaci\u00f3n:&lt;/b&gt;&lt;/span&gt;\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;  C\u00f3digo:&lt;/b&gt;&lt;/span&gt;        4100\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;  Descripci\u00f3n:&lt;/b&gt;&lt;/span&gt;   No solicitada anulaci\u00f3n\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;  Motivo:&lt;/b&gt;&lt;/span&gt;\n</code></pre>"},{"location":"cli/tutorial/intro/","title":"Introducci\u00f3n","text":"<p>En este tutorial puedes obtener una gu\u00eda de primeros pasos para trabajar con FACe desde la interfaz de l\u00ednea de comandos que ofrece AAPP2FACe. Siguiendo este tutorial podr\u00e1s obtener una visi\u00f3n general del uso de la herramienta a trav\u00e9s de las siguientes operaciones:</p> <ul> <li> <p>Realizar la configuraci\u00f3n inicial.</p> </li> <li> <p>Consultar la nuevas facturas registradas en FACe.</p> </li> <li> <p>Descargar facturas y comprobar su estado.</p> </li> <li> <p>Confirmar la descarga de facturas.</p> </li> <li> <p>Cambiar en estado de una factura en FACe.</p> </li> </ul>"},{"location":"cli/tutorial/nuevas-facturas/","title":"Consultar nuevas facturas","text":"<p>El primer paso en un flujo ordinario de trabajo suele ser la consulta de las nuevas facturas registradas en la plataforma FACe por los proveedores. Para realizar esta consulta, solo tienes que invocar el comando <code>aapp2face facturas nuevas</code>. Este comando acepta como par\u00e1metro el codigo DIR3 de la oficina contable para la que quieres realizar la consulta. Si no indicas la oficina contable, el comando devolver\u00e1 todas las facturas del RCF.</p> <pre><code>$ aapp2face facturas nuevas\n\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;N\u00famero registro:&lt;/b&gt;&lt;/span&gt;    &lt;span style=\"color:#A6E22E\"&gt;&lt;b&gt;202001015624&lt;/b&gt;&lt;/span&gt;\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;Fecha registro:&lt;/b&gt;&lt;/span&gt;     2023-01-19 10:57:38\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;Oficina contable:&lt;/b&gt;&lt;/span&gt;   P00000010\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;\u00d3rgano gestor:&lt;/b&gt;&lt;/span&gt;      P00000010\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;Unidad tramitadora:&lt;/b&gt;&lt;/span&gt; P00000010\n\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;N\u00famero registro:&lt;/b&gt;&lt;/span&gt;    &lt;span style=\"color:#A6E22E\"&gt;&lt;b&gt;202001017112&lt;/b&gt;&lt;/span&gt;\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;Fecha registro:&lt;/b&gt;&lt;/span&gt;     2013-01-20 11:05:51\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;Oficina contable:&lt;/b&gt;&lt;/span&gt;   P00000010\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;\u00d3rgano gestor:&lt;/b&gt;&lt;/span&gt;      P00000010\n&lt;span style=\"color:#66D9EF\"&gt;&lt;b&gt;Unidad tramitadora:&lt;/b&gt;&lt;/span&gt; P00000010\n\n&lt;span style=\"color:#A6E22E\"&gt;&lt;b&gt;2&lt;/b&gt;&lt;/span&gt; nuevas facturas disponibles\n</code></pre>"},{"location":"lib/intro/","title":"Introducci\u00f3n","text":"<p>AAPP2FACe es una librer\u00eda que permite abstraer los procesos de comunicaci\u00f3n que deben realizar las AAPP para comunicarse con FACe, dotando a los desarrolladores de una interfaz moderna en Python f\u00e1cil de usar. Se trata de liberar al desarrollador de conocer los detalles subyacentes del proceso y evitar que tengan que lidiar con el protocolo SOAP y la forma de acceso a este tipo de servicios web, pero sin perder el control de la granularidad de las operaciones.</p> <p>Para ello la librer\u00eda proporciona el conector <code>FACeSoapClient</code>, que facilita el acceso a los m\u00e9todos SOAP disponibles en el servicio web de FACe. Esta clase es una implementaci\u00f3n de la interfaz <code>FACeClient</code> que asegura el nivel de coherencia y uniformidad requerido por el dise\u00f1o.</p> <p>Sin embargo, normalmente no querr\u00e1s interactuar directamente con estas clases, sino que lo har\u00e1s principalmente con la interfaz p\u00fablica ofrecida por la clase <code>FACeConnection</code>. Esta clase realiza las conversiones y adaptaciones adecuadas para ofrecer m\u00e9todos y tipos de datos al estilo Python.</p> <p>Para hacer uso de esta clase, durante su creaci\u00f3n, ser\u00e1 necesario inyectar a trav\u00e9s de su constructor una instancia de <code>FACeClient</code> que, a modo de conector, contiene la configuraci\u00f3n de acceso al servicio web. Puedes verlo en el siguiente ejemplo:</p> <pre><code>from aapp2face import FACeConnection, FACeSoapClient\n\ncliente = FACeSoapClient(\n    \"https://se-face-webservice.redsara.es/facturasrcf2?wsdl\",\n    \"cert.pem\",\n    \"key.pem\"\n)\n\nface = FACeConnection(cliente)\n</code></pre> <p>En el ejemplo se crea un objeto <code>FACeSoapClient</code> al que se le proporciona la URL del WSDL que describe el servicio web y que en el ejemplo corresponde con el entorno de pruebas de FACe. Junto a la URL es necesario facilitar la ruta a los archivos que contienen el certificado digital y su correspondiente clave privada para firmar las peticiones al servicio web. Este certificado debe haber sido previamente registrado y autorizado en FACe para identificar al RCF del Organismo que realiza la petici\u00f3n.</p> <p>Posteriormente, se crea un objeto <code>FACeConnection</code> inyectando la instancia de <code>FACeSoapClient</code> a trav\u00e9s de un argumento del constructor. A partir de este momento, ya se puede interactuar con instancia de <code>FACeConnection</code> creada.</p> <p>A continuaci\u00f3n se muestra un ejemplo sencillo de un script que consulta la nuevas facturas disponibles en la plataforma y seguidamente las descarga. Para cada factura crea un directorio que tiene como nombre el n\u00famero de registro de la factura. Dentro del directorio descargar\u00e1 el archivo principal de la factura electr\u00f3nica, normalmente un archivo XSIG, y los anexos que esta pudiera contener, normalmente archivos PDF.</p> <pre><code>from aapp2face import FACeConnection, FACeSoapClient\n\ncliente = FACeSoapClient(\n    \"https://se-face-webservice.redsara.es/facturasrcf2?wsdl\",\n    \"cert.pem\",\n    \"key.pem\"\n)\n\nface = FACeConnection(cliente)\n\nnuevas_facturas = face.solicitar_nuevas_facturas()\n\nfor factura in nuevas_facturas:\n    print(f\"Descargando factura {factura.numero_registro}\")\n    factura_descargada = face.descargar_factura(factura.numero_registro)\n\n    ruta_descarga = Path.cwd().joinpath(factura.numero_registro)\n    ruta_descarga.mkdir()\n\n    factura_descargada.guardar(ruta_descarga)\n\n    for anexo in factura_descargada.anexos:\n        anexo.guardar(ruta_descarga)\n</code></pre>"},{"location":"lib/api/FACeClient/","title":"FACeClient","text":"<p>         Bases: <code>ABC</code></p> <p>Interfaz de los conectores FACe.</p>"},{"location":"lib/api/FACeClient/#aapp2face.lib.client.FACeClient.consultar_estados","title":"<code>consultar_estados()</code>  <code>abstractmethod</code>","text":"<p>Consultar la lista de estados que maneja FACe.</p>"},{"location":"lib/api/FACeClient/#aapp2face.lib.client.FACeClient.consultar_unidades","title":"<code>consultar_unidades()</code>  <code>abstractmethod</code>","text":"<p>Consultar las relaciones OG-UT-OC asociadas al RCF.</p>"},{"location":"lib/api/FACeClient/#aapp2face.lib.client.FACeClient.solicitar_nuevas_facturas","title":"<code>solicitar_nuevas_facturas(oficina_contable)</code>  <code>abstractmethod</code>","text":"<p>Consultar la lista de facturas en estado 'registrada'.</p>"},{"location":"lib/api/FACeClient/#aapp2face.lib.client.FACeClient.descargar_factura","title":"<code>descargar_factura(numero_registro)</code>  <code>abstractmethod</code>","text":"<p>Descarga de una factura.</p>"},{"location":"lib/api/FACeClient/#aapp2face.lib.client.FACeClient.confirmar_descarga_factura","title":"<code>confirmar_descarga_factura(oficina_contable, numero_registro, codigo_rcf)</code>  <code>abstractmethod</code>","text":"<p>Confirmar descarga de una factura.</p>"},{"location":"lib/api/FACeClient/#aapp2face.lib.client.FACeClient.consultar_factura","title":"<code>consultar_factura(numero_registro)</code>  <code>abstractmethod</code>","text":"<p>Consultar el estado de una factura.</p>"},{"location":"lib/api/FACeClient/#aapp2face.lib.client.FACeClient.consultar_listado_facturas","title":"<code>consultar_listado_facturas(numeros_registro)</code>  <code>abstractmethod</code>","text":"<p>Consultar el estado de varias facturas.</p>"},{"location":"lib/api/FACeClient/#aapp2face.lib.client.FACeClient.cambiar_estado_factura","title":"<code>cambiar_estado_factura(oficina_contable, numero_registro, codigo, comentario)</code>  <code>abstractmethod</code>","text":"<p>Cambiar el estado de una factura.</p>"},{"location":"lib/api/FACeClient/#aapp2face.lib.client.FACeClient.cambiar_estado_listado_facturas","title":"<code>cambiar_estado_listado_facturas(facturas)</code>  <code>abstractmethod</code>","text":"<p>Cambiar el estado de varias facturas.</p>"},{"location":"lib/api/FACeClient/#aapp2face.lib.client.FACeClient.consultar_codigo_rcf","title":"<code>consultar_codigo_rcf(numero_registro)</code>  <code>abstractmethod</code>","text":"<p>Consultar el c\u00f3digo RCF de una factura.</p>"},{"location":"lib/api/FACeClient/#aapp2face.lib.client.FACeClient.cambiar_codigo_rcf","title":"<code>cambiar_codigo_rcf(numero_registro, codigo_rcf)</code>  <code>abstractmethod</code>","text":"<p>Cambiar el c\u00f3digo RCF de una factura.</p>"},{"location":"lib/api/FACeClient/#aapp2face.lib.client.FACeClient.solicitar_nuevas_anulaciones","title":"<code>solicitar_nuevas_anulaciones(oficina_contable)</code>  <code>abstractmethod</code>","text":"<p>Consultar la lista de facturas en estado 'solicitada anulaci\u00f3n'.</p>"},{"location":"lib/api/FACeClient/#aapp2face.lib.client.FACeClient.gestionar_solicitud_anulacion_factura","title":"<code>gestionar_solicitud_anulacion_factura(oficina_contable, numero_registro, codigo, comentario)</code>  <code>abstractmethod</code>","text":"<p>Gestionar la solicitud de anulaci\u00f3n de una factura.</p>"},{"location":"lib/api/FACeClient/#aapp2face.lib.client.FACeClient.gestionar_solicitud_anulacion_listado_facturas","title":"<code>gestionar_solicitud_anulacion_listado_facturas(facturas)</code>  <code>abstractmethod</code>","text":"<p>Gestionar la solicitud de anulaci\u00f3n de varias facturas.</p>"},{"location":"lib/api/FACeClient/#aapp2face.lib.client.FACeClient.consultar_estado_cesion","title":"<code>consultar_estado_cesion(numero_registro)</code>  <code>abstractmethod</code>","text":"<p>Consultar el estado de una cesi\u00f3n</p>"},{"location":"lib/api/FACeClient/#aapp2face.lib.client.FACeClient.obtener_documento_cesion","title":"<code>obtener_documento_cesion(csv, repositorio, solicitante)</code>  <code>abstractmethod</code>","text":"<p>Obtener el documento de la cesi\u00f3n de una factura</p>"},{"location":"lib/api/FACeClient/#aapp2face.lib.client.FACeClient.gestionar_cesion","title":"<code>gestionar_cesion(numero_registro, codigo, comentario)</code>  <code>abstractmethod</code>","text":"<p>Gestionar la cesi\u00f3n de cr\u00e9dito de una factura.</p>"},{"location":"lib/api/FACeClient/#aapp2face.lib.client.FACeClient.notifica_factura","title":"<code>notifica_factura(numero_registro, fecha_registro, factura, organo_gestor, unidad_tramitadora, oficina_contable, codigo_rcf, estado)</code>  <code>abstractmethod</code>","text":"<p>Notificar una factura recibida en otro PGEFe.</p>"},{"location":"lib/api/FACeClient/#aapp2face.lib.client.FACeClient.notifica_factura_no_electronica","title":"<code>notifica_factura_no_electronica(numero_registro, fecha_registro, emisor, receptor, tercero, numero, serie, importe, fecha_expedicion, organo_gestor, unidad_tramitadora, oficina_contable, codigo_rcf, estado, codigo_cnae)</code>  <code>abstractmethod</code>","text":"<p>Notificar una factura no electr\u00f3nica.</p>"},{"location":"lib/api/FACeConnection/","title":"FACeConnection","text":"<p>Clase principal de conexi\u00f3n a FACe.</p> <p>Constructor</p> <p>Parameters:</p> Name Type Description Default <code>client</code> <code>FACeClient</code> <p>Conector a usar</p> required"},{"location":"lib/api/FACeConnection/#aapp2face.lib.main.FACeConnection.consultar_estados","title":"<code>consultar_estados()</code>","text":"<p>Obtiene los estados que maneja FACe para la gesti\u00f3n de una factura.</p> <p>Existen dos flujos principales, el ordinario y el de anulaci\u00f3n. El flujo ordinario corresponde al ciclo de vida de la factura, y el flujo de anulaci\u00f3n corresponde al ciclo de solicitud de anulaci\u00f3n.</p> <p>Returns:</p> Type Description <code>list[Estado]</code> <p>lista de estados que maneja FACe</p>"},{"location":"lib/api/FACeConnection/#aapp2face.lib.main.FACeConnection.consultar_unidades","title":"<code>consultar_unidades()</code>","text":"<p>Obtiene las relaciones OG-UT-OC asociadas al RCF.</p> <p>Las relaciones OG-UT-OC obtenidas son las asociadas al RCF que firma la petici\u00f3n.</p> <p>Returns:</p> Type Description <code>list[Relacion]</code> <p>lista de relaciones OG-UT-OC asociadas al RCF</p>"},{"location":"lib/api/FACeConnection/#aapp2face.lib.main.FACeConnection.solicitar_nuevas_facturas","title":"<code>solicitar_nuevas_facturas(oficina_contable='')</code>","text":"<p>Obtiene las facturas que se encuentran en estado \"Registrada\".</p> <p>El RCF debe usar peri\u00f3dicamente este m\u00e9todo para obtener las facturas que luego deber\u00e1 recuperar.</p> <p>El resultado est\u00e1 limitado a un m\u00e1ximo de 500 facturas. Las facturas deben ser procesadas para que entren el resto de facturas encoladas.</p> <p>Parameters:</p> Name Type Description Default <code>oficina_contable</code> <code>str</code> <p>C\u00f3digo DIR3 de la Oficina Contable. Si no se pasa valor retornar\u00e1 un listado de las facturas del RCF</p> <code>''</code> <p>Returns:</p> Type Description <code>list[NuevaFactura]</code> <p>lista de facturas que se encuentran en estado \"Registrada\"</p>"},{"location":"lib/api/FACeConnection/#aapp2face.lib.main.FACeConnection.descargar_factura","title":"<code>descargar_factura(numero_registro)</code>","text":"<p>Descarga una factura.</p> <p>Este m\u00e9todo \u00fanicamente puede ser invocado para facturas en estado \"Registrada\". En otros casos el servicio web reportar\u00e1 un error. Despu\u00e9s de llamar a este m\u00e9todo, y una vez comprobada la correcta recepci\u00f3n de la factura, el RCF debe llamar al m\u00e9todo <code>confirmar_descarga_factura</code>.</p> <p>Parameters:</p> Name Type Description Default <code>numero_registro</code> <code>str</code> <p>N\u00famero de registro, en el REC, de la factura a descargar</p> required <p>Returns:</p> Type Description <code>DescargaFactura</code> <p>estructura que contiene la factura descargada</p>"},{"location":"lib/api/FACeConnection/#aapp2face.lib.main.FACeConnection.confirmar_descarga_factura","title":"<code>confirmar_descarga_factura(oficina_contable, numero_registro, codigo_rcf)</code>","text":"<p>Confirma la descarga de una factura.</p> <p>Este m\u00e9todo es complementario al m\u00e9todo <code>descargar_factura</code>, es decir, el RCF deber\u00e1 solicitar la confirmaci\u00f3n de cada factura descargada que se haya completado con \u00e9xito, de forma que la plataforma FACe pueda realizar todas las acciones relacionadas con la descarga de factura por parte del RCF. Dicho m\u00e9todo actualiza la factura al estado 1300 autom\u00e1ticamente.</p> <p>Parameters:</p> Name Type Description Default <code>oficina_contable</code> <code>str</code> <p>C\u00f3digo DIR3 de la Oficina Contable</p> required <code>numero_registro</code> <code>str</code> <p>N\u00famero de registro, en el REC, de la factura para la que se quiere confirmar su descarga</p> required <code>codigo_rcf</code> <code>str</code> <p>C\u00f3digo del RCF a asignar a la factura</p> required <p>Returns:</p> Type Description <code>ConfirmaDescargaFactura</code> <p>estructura que contiene los datos de la confirmaci\u00f3n</p>"},{"location":"lib/api/FACeConnection/#aapp2face.lib.main.FACeConnection.consultar_factura","title":"<code>consultar_factura(numero_registro)</code>","text":"<p>Consulta el estado de una factura.</p> <p>Parameters:</p> Name Type Description Default <code>numero_registro</code> <code>str</code> <p>N\u00famero de registro, en el REC, de la factura para la que se quiere consultar su estado</p> required <p>Returns:</p> Type Description <code>ConsultarFactura</code> <p>estructura que contiene los datos del estado de una factura</p>"},{"location":"lib/api/FACeConnection/#aapp2face.lib.main.FACeConnection.consultar_listado_facturas","title":"<code>consultar_listado_facturas(numeros_registro)</code>","text":"<p>Consulta el estado de varias facturas.</p> <p>El servicio web limita a un m\u00e1ximo de 500 facturas la consulta.</p> <p>Parameters:</p> Name Type Description Default <code>numeros_registro</code> <code>list[str]</code> <p>Lista de n\u00fameros de registro, en el REC, de las facturas para las que se quiere consultar su estado</p> required <p>Returns:</p> Type Description <code>list[ConsultarFactura | FACeItemResult]</code> <p>lista con el estado de cada factura o incidencia al consultar</p>"},{"location":"lib/api/FACeConnection/#aapp2face.lib.main.FACeConnection.cambiar_estado_factura","title":"<code>cambiar_estado_factura(oficina_contable, numero_registro, codigo, comentario)</code>","text":"<p>Cambia el estado de una factura.</p> <p>Los estados 1300 y 3100 no pueden ser asignados mediante este m\u00e9todo ya que estos estados son asignados de forma autom\u00e1tica al realizar las operaciones de confirmaci\u00f3n de descarga de la factura y gesti\u00f3n de la solicitud de anulaci\u00f3n respectivamente. El estado inicial 1200 tampoco es gestionable mediante este m\u00e9todo.</p> <p>Parameters:</p> Name Type Description Default <code>oficina_contable</code> <code>str</code> <p>C\u00f3digo DIR3 de la Oficina Contable</p> required <code>numero_registro</code> <code>str</code> <p>N\u00famero de registro, en el REC, de la factura para la que se quiere cambiar su estado</p> required <code>codigo</code> <code>str</code> <p>Identificador del estado a asignar</p> required <code>comentario</code> <code>str</code> <p>Comentario asociado al cambio de estado de la factura</p> required <p>Returns:</p> Type Description <code>CambiarEstadoFactura</code> <p>estructura que contiene los datos del cambio de estado de la factura</p>"},{"location":"lib/api/FACeConnection/#aapp2face.lib.main.FACeConnection.cambiar_estado_listado_facturas","title":"<code>cambiar_estado_listado_facturas(facturas)</code>","text":"<p>Cambia el estado de varias facturas.</p> <p>Las restricciones que el servicio web presenta para esta operaci\u00f3n son las mismas aplicadas al m\u00e9todo <code>cambiar_estado_factura</code>.</p> <p>El servicio web limita a un m\u00e1ximo de 100 facturas la petici\u00f3n.</p> <p>Parameters:</p> Name Type Description Default <code>facturas</code> <code>list[PeticionCambiarEstadoFactura]</code> <p>Lista de peticiones con los datos de las facturas a cambiar</p> required <p>Returns:</p> Type Description <code>list[CambiarEstadoFactura | FACeItemResult]</code> <p>lista con el cambio de estado de cada factura o incidencia al cambiar</p>"},{"location":"lib/api/FACeConnection/#aapp2face.lib.main.FACeConnection.consultar_codigo_rcf","title":"<code>consultar_codigo_rcf(numero_registro)</code>","text":"<p>Obtiene el c\u00f3digo RCF de una factura registrado en FACe.</p> <p>Parameters:</p> Name Type Description Default <code>numero_registro</code> <code>str</code> <p>N\u00famero de registro, en el REC, de la factura para la que se quiere consultar su c\u00f3digo RCF</p> required <p>Returns:</p> Type Description <code>str</code> <p>c\u00f3digo RCF registrado en FACe para la factura</p>"},{"location":"lib/api/FACeConnection/#aapp2face.lib.main.FACeConnection.cambiar_codigo_rcf","title":"<code>cambiar_codigo_rcf(numero_registro, codigo_rcf)</code>","text":"<p>Cambia el c\u00f3digo RCF de una factura.</p> <p>Parameters:</p> Name Type Description Default <code>numero_registro</code> <code>str</code> <p>N\u00famero de registro, en el REC, de la factura para la que se quiere cambiar su c\u00f3digo RCF</p> required <code>codigo_rcf</code> <code>str</code> <p>C\u00f3digo RCF a asignar a la factura</p> required <p>Returns:</p> Type Description <code>str</code> <p>c\u00f3digo RCF asignado a la factura</p>"},{"location":"lib/api/FACeConnection/#aapp2face.lib.main.FACeConnection.solicitar_nuevas_anulaciones","title":"<code>solicitar_nuevas_anulaciones(oficina_contable='')</code>","text":"<p>Obtiene las facturas que se encuentran en estado \"Solicitada anulaci\u00f3n\".</p> <p>El RCF debe usar peri\u00f3dicamente este m\u00e9todo para conocer las solicitudes de anulaci\u00f3n de facturas realizadas en FACe por parte de los proveedores.</p> <p>El resultado est\u00e1 limitado a un m\u00e1ximo de 500 facturas. Las solicitudes deben ser procesadas para que entren el resto de solicitudes encoladas.</p> <p>Parameters:</p> Name Type Description Default <code>oficina_contable</code> <code>str</code> <p>C\u00f3digo DIR3 de la Oficina Contable. Si no se pasa valor retornar\u00e1 un listado de las facturas del RCF</p> <code>''</code> <p>Returns:</p> Type Description <code>list[NuevaAnulacion]</code> <p>lista de facturas que se encuentran en estado \"Solicitada anulaci\u00f3n\"</p>"},{"location":"lib/api/FACeConnection/#aapp2face.lib.main.FACeConnection.gestionar_solicitud_anulacion_factura","title":"<code>gestionar_solicitud_anulacion_factura(oficina_contable, numero_registro, codigo, comentario)</code>","text":"<p>Gestiona una solicitud de anulaci\u00f3n, aceptando o rechazando dicha solicitud.</p> <p>Parameters:</p> Name Type Description Default <code>oficina_contable</code> <code>str</code> <p>C\u00f3digo DIR3 de la Oficina Contable</p> required <code>numero_registro</code> <code>str</code> <p>N\u00famero de registro, en el REC, de la factura para la que se quiere gestionar su solicitud de anulaci\u00f3n</p> required <code>codigo</code> <code>str</code> <p>Identificador del estado a asignar</p> required <code>comentario</code> <code>str</code> <p>Comentario asociado a la gesti\u00f3n de la solicitud de anulaci\u00f3n</p> required <p>Returns:</p> Type Description <code>GestionarSolicitudAnulacionFactura</code> <p>estructura que contiene los datos de la gesti\u00f3n de la anulaci\u00f3n</p>"},{"location":"lib/api/FACeConnection/#aapp2face.lib.main.FACeConnection.gestionar_solicitud_anulacion_listado_facturas","title":"<code>gestionar_solicitud_anulacion_listado_facturas(facturas)</code>","text":"<p>Gestiona la solicitud de anulaci\u00f3n de varias facturas.</p> <p>El servicio web limita a un m\u00e1ximo de 100 facturas la petici\u00f3n.</p> <p>Parameters:</p> Name Type Description Default <code>facturas</code> <code>list[PeticionSolicitudAnulacionListadoFactura]</code> <p>Lista de peticiones con los datos de las solicitudes de anulaci\u00f3n a gestionar</p> required <p>Returns:</p> Type Description <code>list[GestionarSolicitudAnulacionFactura | FACeItemResult]</code> <p>lista con la gesti\u00f3n de la anulaci\u00f3n o incidencia al realizarla</p>"},{"location":"lib/api/FACeConnection/#aapp2face.lib.main.FACeConnection.consultar_estado_cesion","title":"<code>consultar_estado_cesion(numero_registro)</code>","text":"<p>Obtiene el estado de la cesi\u00f3n de una factura.</p> <p>Parameters:</p> Name Type Description Default <code>numero_registro</code> <code>str</code> <p>N\u00famero de registro, en el REC, de la factura para la que quiere consultarse el estado de la cesi\u00f3n</p> required <p>Returns:</p> Type Description <code>EstadoCesion</code> <p>estructura que contiene el estado de la cesi\u00f3n</p>"},{"location":"lib/api/FACeConnection/#aapp2face.lib.main.FACeConnection.obtener_documento_cesion","title":"<code>obtener_documento_cesion(csv, repositorio, solicitante)</code>","text":"<p>Obtiene el documento de la cesi\u00f3n de una factura.</p> <p>Este m\u00e9todo permite obtener el documento de la cesi\u00f3n conectando al servicio de notarios.</p> <p>Parameters:</p> Name Type Description Default <code>csv</code> <code>str</code> <p>Identificador del documento</p> required <code>repositorio</code> <code>str</code> <p>Repositorio desde el que se obtiene el documento</p> required <code>solicitante</code> <code>DatosSolicitante</code> <p>Datos del solicitante (nif, nombre, apellidos)</p> required <p>Returns:</p> Type Description <code>DocumentoCesion</code> <p>estructura de datos que contiene el documento de la cesi\u00f3n</p>"},{"location":"lib/api/FACeConnection/#aapp2face.lib.main.FACeConnection.gestionar_cesion","title":"<code>gestionar_cesion(numero_registro, codigo, comentario)</code>","text":"<p>Gestiona una cesi\u00f3n de cr\u00e9dito, aceptando o rechazando dicha cesi\u00f3n.</p> <p>Parameters:</p> Name Type Description Default <code>numero_registro</code> <code>str</code> <p>N\u00famero de registro, en el REC, de la factura para la que quiere gestionarse la cesi\u00f3n de cr\u00e9dito</p> required <code>codigo</code> <code>str</code> <p>Identificador del estado a asignar</p> required <code>comentario</code> <code>str</code> <p>Comentario asociado a la gesti\u00f3n de la cesi\u00f3n de cr\u00e9dito</p> required <p>Returns:</p> Type Description <code>GestionarCesion</code> <p>estructura que contiene el resultado de la gesti\u00f3n de la cesi\u00f3n</p>"},{"location":"lib/api/FACeConnection/#aapp2face.lib.main.FACeConnection.notifica_factura","title":"<code>notifica_factura(numero_registro, fecha_registro, path_factura, organo_gestor, unidad_tramitadora, oficina_contable, codigo_rcf, estado)</code>","text":"<p>Notifica una factura recibida en otro PGEFe.</p> <p>Este m\u00e9todo permite notificar una factura recibida en otro PGEFe. El servicio retorna un n\u00famero de registro y fecha de registro para poder consultar y operar la factura en FACe.</p> <p>Parameters:</p> Name Type Description Default <code>numero_registro</code> <code>str</code> <p>N\u00famero de registro del PGEFe</p> required <code>fecha_registro</code> <code>str</code> <p>Fecha de registro del PGEFe formato en 'YYYY-MM-DDThh:mm:ss'</p> required <code>path_factura</code> <code>str</code> <p>Ruta local del fichero con la factura, en formato facturae 3.2 o 3.2.1, a enviar</p> required <code>organo_gestor</code> <code>str</code> <p>C\u00f3digo DIR3 del \u00d3rgano Gestor</p> required <code>unidad_tramitadora</code> <code>str</code> <p>C\u00f3digo DIR3 de la Unidad Tramitadora</p> required <code>oficina_contable</code> <code>str</code> <p>C\u00f3digo DIR3 del Oficina Contable</p> required <code>codigo_rcf</code> <code>str</code> <p>C\u00f3digo asignado dentro del RCF</p> required <code>estado</code> <code>str</code> <p>C\u00f3digo del estado de la factura</p> required <p>Returns:</p> Type Description <code>NotificaFactura</code> <p>estructura de datos que contiene un n\u00famero de registro y fecha de registro para poder consultar y operar la factura en FACe</p>"},{"location":"lib/api/FACeConnection/#aapp2face.lib.main.FACeConnection.notifica_factura_no_electronica","title":"<code>notifica_factura_no_electronica(numero_registro, fecha_registro, emisor, receptor, tercero, numero, serie, importe, fecha_expedicion, organo_gestor, unidad_tramitadora, oficina_contable, codigo_rcf, estado, codigo_cnae)</code>","text":"<p>Notifica una factura no electr\u00f3nica recibida.</p> <p>Este m\u00e9todo permite notificar una factura no electr\u00f3nica recibida en el registro administrativo de un Organismo. El servicio retorna un n\u00famero de registro y fecha de registro para poder consultar y operar la factura en FACe.</p> <p>Parameters:</p> Name Type Description Default <code>numero_registro</code> <code>str</code> <p>N\u00famero de registro del PGEFe</p> required <code>fecha_registro</code> <code>str</code> <p>Fecha de registro del PGEFe en formato 'YYYY-MM-DDThh:mm:ss'</p> required <code>emisor</code> <code>DatosPersonales</code> <p>Datos del emisor</p> required <code>receptor</code> <code>DatosPersonales</code> <p>Datos del receptor</p> required <code>tercero</code> <code>DatosPersonales</code> <p>Datos del tercero</p> required <code>numero</code> <code>str</code> <p>N\u00famero de la factura</p> required <code>serie</code> <code>str</code> <p>Serie de la factura</p> required <code>importe</code> <code>str</code> <p>Importe de la factura</p> required <code>fecha_expedicion</code> <code>str</code> <p>Fecha de expedici\u00f3n de la factura en formato 'YYYY-MM-DDThh:mm:ss'</p> required <code>organo_gestor</code> <code>str</code> <p>C\u00f3digo DIR3 del \u00d3rgano Gestor</p> required <code>unidad_tramitadora</code> <code>str</code> <p>C\u00f3digo DIR3 de la Unidad Tramitadora</p> required <code>oficina_contable</code> <code>str</code> <p>C\u00f3digo DIR3 del Oficina Contable</p> required <code>codigo_rcf</code> <code>str</code> <p>C\u00f3digo asignado dentro de RCF</p> required <code>estado</code> <code>str</code> <p>C\u00f3digo del estado de la factura</p> required <code>codigo_cnae</code> <code>str</code> <p>C\u00f3digo de CNAE de la factura</p> required <p>Returns:</p> Type Description <code>NotificaFactura</code> <p>estructura de datos que contiene un n\u00famero de registro y fecha de registro para poder consultar y operar la factura en FACe.</p>"},{"location":"lib/api/FACeFakeSoapClient/","title":"FACeFakeSoapClient","text":"<p>         Bases: <code>FACeClient</code></p> <p>Clase del conector FACe para simulaci\u00f3n a partir de archivos preconfigurados.</p> <p>Constructor</p> <p>Parameters:</p> Name Type Description Default <code>responses_path</code> <code>Path</code> <p>Ruta de los archivos respuesta preconfigurados</p> required"},{"location":"lib/api/FACeSoapClient/","title":"FACeSoapClient","text":"<p>         Bases: <code>FACeClient</code></p> <p>Clase del conector FACe usando SOAP.</p> <p>Constructor</p> <p>Parameters:</p> Name Type Description Default <code>wsdl</code> <code>str</code> <p>Ruta del WSDL del servicio SOAP</p> required <code>cert</code> <code>str</code> <p>Ruta del archivo que contiene el certificado para firmar las peticiones SOAP</p> required <code>key</code> <code>str</code> <p>Ruta del archivo que contiene la clave privada del certificado</p> required <code>debug</code> <code>bool</code> <p>Flag que indica se se guarda registro de peticiones. Default: False</p> <code>False</code> <code>log_path</code> <code>str</code> <p>Ruta donde se ubicar\u00e1 el registro de peticiones. Default: \".\"</p> <code>'.'</code>"},{"location":"lib/api/exceptions/","title":"Excepciones","text":"<p>exceptions.py</p> <p>M\u00f3dulo de clases para excepciones.</p>"},{"location":"lib/api/exceptions/#aapp2face.lib.exceptions.FACeException","title":"<code>FACeException</code>","text":"<p>         Bases: <code>Exception</code></p> <p>Clase base para excepciones por errores reportados por FACe.</p>"},{"location":"lib/api/exceptions/#aapp2face.lib.exceptions.UndefinedError","title":"<code>UndefinedError</code>","text":"<p>         Bases: <code>FACeException</code></p> <p>El proceso finaliz\u00f3 con error. El error no ha sido determinado, pudo deberse a problemas de comunicaci\u00f3n con otras plataformas, problemas de datos, etc.).</p>"},{"location":"lib/api/exceptions/#aapp2face.lib.exceptions.UndocumentedException","title":"<code>UndocumentedException</code>","text":"<p>         Bases: <code>FACeException</code></p> <p>Lanzada cuando FACe devuelve un c\u00f3digo de resultado no documentado.</p>"},{"location":"lib/api/exceptions/#aapp2face.lib.exceptions.SOAPSecurityException","title":"<code>SOAPSecurityException</code>","text":"<p>         Bases: <code>FACeException</code></p> <p>Lanzada por errores en verificaci\u00f3n de seguridad SOAP.</p>"},{"location":"lib/api/exceptions/#aapp2face.lib.exceptions.AfirmaVerificationException","title":"<code>AfirmaVerificationException</code>","text":"<p>         Bases: <code>FACeException</code></p> <p>Lanzada por errores en la verificaci\u00f3n con Afirma.</p>"},{"location":"lib/api/exceptions/#aapp2face.lib.exceptions.FACeManagementException","title":"<code>FACeManagementException</code>","text":"<p>         Bases: <code>FACeException</code></p> <p>Lanzada por errores asociados a la gesti\u00f3n en FACe.</p>"},{"location":"lib/api/objects/","title":"Objetos","text":"<p>objects.py</p> <p>M\u00f3dulo de clases para estructuras de datos.</p>"},{"location":"lib/api/objects/#aapp2face.lib.objects.FACeResult","title":"<code>FACeResult</code>  <code>dataclass</code>","text":"<p>Clase para resultados devueltos por FACe.</p> <p>Attributes:</p> Name Type Description <code>codigo</code> <code>str</code> <p>C\u00f3digo de resultado devuelto por FACe</p> <code>descripcion</code> <code>str</code> <p>Descripci\u00f3n asociada al resultado devuelto por FACe</p> <code>codigo_seguimiento</code> <code>str</code> <p>C\u00f3digo asociado al registro de la llamada. Este c\u00f3digo puede ser solicitado para resoluci\u00f3n de incidencias</p>"},{"location":"lib/api/objects/#aapp2face.lib.objects.Estado","title":"<code>Estado</code>  <code>dataclass</code>","text":"<p>Clase para respuesta FACe con datos de cada uno de los estados que maneja</p> <p>Attributes:</p> Name Type Description <code>flujo</code> <code>str</code> <p>Flujo al que pertenece el estado</p> <code>nombre</code> <code>str</code> <p>Nombre interno del estado</p> <code>nombre_publico</code> <code>str</code> <p>Nombre externo del estado</p> <code>codigo</code> <code>str</code> <p>Identificador del estado</p> <code>descripcion</code> <code>str</code> <p>Descripci\u00f3n del estado</p>"},{"location":"lib/api/objects/#aapp2face.lib.objects.UnidadDir3","title":"<code>UnidadDir3</code>  <code>dataclass</code>","text":"<p>Clase para respuesta FACe con datos de una unidad DIR3</p> <p>Attributes:</p> Name Type Description <code>nombre</code> <code>str</code> <p>Nombre de la unidad</p> <code>codigo</code> <code>str</code> <p>C\u00f3digo DIR3 de la unidad</p>"},{"location":"lib/api/objects/#aapp2face.lib.objects.Relacion","title":"<code>Relacion</code>  <code>dataclass</code>","text":"<p>Clase para respuesta FACe con datos de una relaci\u00f3n OG-UT-OC</p> <p>Attributes:</p> Name Type Description <code>organo_gestor</code> <code>UnidadDir3</code> <p>Identificaci\u00f3n del \u00d3rgano Gestor</p> <code>unidad_tramitadora</code> <code>UnidadDir3</code> <p>Identificaci\u00f3n de la Unidad Tramitadora</p> <code>oficina_contable</code> <code>UnidadDir3</code> <p>Identificaci\u00f3n de la Oficina Contable</p>"},{"location":"lib/api/objects/#aapp2face.lib.objects.NuevaFactura","title":"<code>NuevaFactura</code>  <code>dataclass</code>","text":"<p>Clase para respuestas FACe al consultar nuevas facturas.</p> <p>Attributes:</p> Name Type Description <code>numero_registro</code> <code>str</code> <p>N\u00famero de registro de la factura dentro de FACe</p> <code>oficina_contable</code> <code>str</code> <p>C\u00f3digo DIR3 de la Oficina Contable</p> <code>organo_gestor</code> <code>str</code> <p>C\u00f3digo DIR3 del \u00d3rgano Gestor</p> <code>unidad_tramitadora</code> <code>str</code> <p>C\u00f3digo DIR3 de la Unidad Tramitadora</p> <code>fecha_hora_registro</code> <code>str</code> <p>Fecha y hora de registro de la factura</p>"},{"location":"lib/api/objects/#aapp2face.lib.objects.AnexoFactura","title":"<code>AnexoFactura</code>  <code>dataclass</code>","text":"<p>Clase para respuesta FACe con anexo a una factura</p> <p>Attributes:</p> Name Type Description <code>anexo</code> <code>str</code> <p>Documento del anexo en base64</p> <code>nombre</code> <code>str</code> <p>Nombre del archivo del anexo</p> <code>mime</code> <code>str</code> <p>Formato del archivo</p>"},{"location":"lib/api/objects/#aapp2face.lib.objects.AnexoFactura.guardar","title":"<code>guardar(path=None, force=False)</code>","text":"<p>Crea un archivo con el anexo decodificado.</p> <p>Parameters:</p> Name Type Description Default <code>path</code> <code>str, optional</code> <p>Ruta donde se guardar\u00e1 el anexo decodificada</p> <code>None</code> <code>force</code> <code>bool, optional</code> <p>Sobrescribe el archivo si existe. En caso contrario lanza una excepci\u00f3n. Por defecto False</p> <code>False</code>"},{"location":"lib/api/objects/#aapp2face.lib.objects.DescargaFactura","title":"<code>DescargaFactura</code>  <code>dataclass</code>","text":"<p>Clase para respuesta FACe con una factura descargada</p> <p>Attributes:</p> Name Type Description <code>numero</code> <code>str</code> <p>N\u00famero de la factura</p> <code>serie</code> <code>str</code> <p>Serie de la factura</p> <code>importe</code> <code>str</code> <p>Importe de la factura</p> <code>proveedor</code> <code>str</code> <p>Nombre del proveedor</p> <code>nombre</code> <code>str</code> <p>Nombre del archivo de la factura</p> <code>factura</code> <code>str</code> <p>Documento de la factura en base64</p> <code>mime</code> <code>str</code> <p>Formato del archivo</p> <code>anexos</code> <code>list[AnexoFactura]</code> <p>Lista de anexos de la factura</p>"},{"location":"lib/api/objects/#aapp2face.lib.objects.DescargaFactura.guardar","title":"<code>guardar(path=None, force=False)</code>","text":"<p>Crea un archivo con la factura decodificada.</p> <p>Parameters:</p> Name Type Description Default <code>path</code> <code>str, optional</code> <p>Ruta donde se guardar\u00e1 la factura decodificada</p> <code>None</code> <code>force</code> <code>bool, optional</code> <p>Sobrescribe el archivo si existe. En caso contrario lanza una excepci\u00f3n. Por defecto False</p> <code>False</code>"},{"location":"lib/api/objects/#aapp2face.lib.objects.ConfirmaDescargaFactura","title":"<code>ConfirmaDescargaFactura</code>  <code>dataclass</code>","text":"<p>Clase para respuesta FACe al confirmar descarga de una factura.</p> <p>Attributes:</p> Name Type Description <code>numero_registro</code> <code>str</code> <p>N\u00famero de registro de la factura dentro de FACe</p> <code>oficina_contable</code> <code>str</code> <p>C\u00f3digo DIR3 de la Oficina Contable</p> <code>codigo</code> <code>str</code> <p>Identificador del estado asignado</p>"},{"location":"lib/api/objects/#aapp2face.lib.objects.ConsultarEstadoFactura","title":"<code>ConsultarEstadoFactura</code>  <code>dataclass</code>","text":"<p>Clase para estado de una factura en FACe dentro de un flujo de tramitaci\u00f3n.</p> <p>Attributes:</p> Name Type Description <code>codigo</code> <code>str</code> <p>Identificador del estado de una factura</p> <code>descripcion</code> <code>str</code> <p>Descripci\u00f3n del c\u00f3digo de estado</p> <code>motivo</code> <code>str</code> <p>Comentario que se indic\u00f3 al asignar el estado</p>"},{"location":"lib/api/objects/#aapp2face.lib.objects.ConsultarFactura","title":"<code>ConsultarFactura</code>  <code>dataclass</code>","text":"<p>Clase para respuesta FACe al consultar estado de una factura.</p> <p>Attributes:</p> Name Type Description <code>numero_registro</code> <code>str</code> <p>N\u00famero de registro de la factura dentro de FACe</p> <code>tramitacion</code> <code>ConsultarEstadoFactura</code> <p>Estado de la factura en el flujo ordinario</p> <code>anulacion</code> <code>ConsultarEstadoFactura</code> <p>Estado de la factura en el flujo de anulaci\u00f3n</p>"},{"location":"lib/api/objects/#aapp2face.lib.objects.FACeItemResult","title":"<code>FACeItemResult</code>  <code>dataclass</code>","text":"<p>Clase para resultados por elemento en arrays devueltos por FACe.</p> <p>Attributes:</p> Name Type Description <code>codigo</code> <code>str</code> <p>C\u00f3digo de resultado devuelto por FACe</p> <code>descripcion</code> <code>str</code> <p>Descripci\u00f3n asociada al resultado devuelto por FACe</p> <code>id</code> <code>str</code> <p>Identificador de referencia en la operaci\u00f3n que provoc\u00f3 el resultado. Por ejemplo un n\u00famero de registro de una factura</p>"},{"location":"lib/api/objects/#aapp2face.lib.objects.CambiarEstadoFactura","title":"<code>CambiarEstadoFactura</code>  <code>dataclass</code>","text":"<p>Clase para respuesta FACe al cambiar estado de una factura.</p> <p>Attributes:</p> Name Type Description <code>numero_registro</code> <code>str</code> <p>N\u00famero de registro de la factura dentro de FACe</p> <code>codigo</code> <code>str</code> <p>Identificador del estado asignado</p>"},{"location":"lib/api/objects/#aapp2face.lib.objects.PeticionCambiarEstadoFactura","title":"<code>PeticionCambiarEstadoFactura</code>  <code>dataclass</code>","text":"<p>Clase para peticiones FACe al cambiar estado de un listado de facturas.</p> <p>Attributes:</p> Name Type Description <code>oficina_contable</code> <code>str</code> <p>C\u00f3digo DIR3 de la Oficina Contable.</p> <code>numero_registro</code> <code>str</code> <p>N\u00famero de registro de la factura dentro de FACe.</p> <code>codigo</code> <code>str</code> <p>Identificador del estado a asignar.</p> <code>comentario</code> <code>str</code> <p>Comentario asociado al cambio de estado de la factura.</p>"},{"location":"lib/api/objects/#aapp2face.lib.objects.NuevaAnulacion","title":"<code>NuevaAnulacion</code>  <code>dataclass</code>","text":"<p>Clase para respuestas FACe al consultar las solicitudes de anulaci\u00f3n.</p> <p>Attributes:</p> Name Type Description <code>numero_registro</code> <code>str</code> <p>N\u00famero de registro de la factura dentro de FACe</p> <code>oficina_contable</code> <code>str</code> <p>C\u00f3digo DIR3 de la Oficina Contable</p> <code>organo_gestor</code> <code>str</code> <p>C\u00f3digo DIR3 del \u00d3rgano Gestor</p> <code>unidad_tramitadora</code> <code>str</code> <p>C\u00f3digo DIR3 de la Unidad Tramitadora</p> <code>fecha_hora_solicitud</code> <code>str</code> <p>Fecha y hora de la solicitud de anulaci\u00f3n</p> <code>motivo</code> <code>str</code> <p>Motivo de la solicitud de anulaci\u00f3n indicada por el proveedor</p>"},{"location":"lib/api/objects/#aapp2face.lib.objects.GestionarSolicitudAnulacionFactura","title":"<code>GestionarSolicitudAnulacionFactura</code>  <code>dataclass</code>","text":"<p>Clase para respuesta FACe al gestionar solicitud anulaci\u00f3n de una factura.</p> <p>Attributes:</p> Name Type Description <code>numero_registro</code> <code>str</code> <p>N\u00famero de registro de la factura dentro de FACe</p> <code>codigo</code> <code>str</code> <p>Identificador del estado asignado</p>"},{"location":"lib/api/objects/#aapp2face.lib.objects.PeticionSolicitudAnulacionListadoFactura","title":"<code>PeticionSolicitudAnulacionListadoFactura</code>  <code>dataclass</code>","text":"<p>Clase para peticiones FACe al gestionar la solicitud de anulaci\u00f3n de un listado de facturas.</p> <p>Attributes:</p> Name Type Description <code>oficina_contable</code> <code>str</code> <p>C\u00f3digo DIR3 de la Oficina Contable</p> <code>numero_registro</code> <code>str</code> <p>N\u00famero de registro de la factura dentro de FACe</p> <code>codigo</code> <code>str</code> <p>Identificador del estado a asignar</p> <code>comentario</code> <code>str</code> <p>Comentario asociado a la gesti\u00f3n de la solicitud de anulaci\u00f3n</p>"},{"location":"lib/api/objects/#aapp2face.lib.objects.EstadoCesion","title":"<code>EstadoCesion</code>  <code>dataclass</code>","text":"<p>Clase para repuesta FACe al consultar el estado de una cesi\u00f3n de cr\u00e9dito.</p> <p>Attributes:</p> Name Type Description <code>numero_registro</code> <code>str</code> <p>N\u00famero de registro de la factura dentro de FACe</p> <code>codigo</code> <code>str</code> <p>Identificador del estado de la cesi\u00f3n de cr\u00e9dito</p> <code>comentario</code> <code>str</code> <p>Comentario asociado al estado de cesi\u00f3n de cr\u00e9dito</p>"},{"location":"lib/api/objects/#aapp2face.lib.objects.DatosSolicitante","title":"<code>DatosSolicitante</code>  <code>dataclass</code>","text":"<p>Clase para datos solicitante en peticiones FACe para obtener documento de cesi\u00f3n.</p> <p>Attributes:</p> Name Type Description <code>nif</code> <code>str</code> <p>NIF del solicitante para obtener documento de cesi\u00f3n</p> <code>nombre</code> <code>str</code> <p>Nombre del solicitante para obtener documento de cesi\u00f3n</p> <code>apellidos</code> <code>str</code> <p>Apellidos del solicitante para obtener documento de cesi\u00f3n</p>"},{"location":"lib/api/objects/#aapp2face.lib.objects.DocumentoCesion","title":"<code>DocumentoCesion</code>  <code>dataclass</code>","text":"<p>Clase para respuesta FACe con el documento de una cesi\u00f3n de cr\u00e9dito</p> <p>Attributes:</p> Name Type Description <code>numero_registro</code> <code>str</code> <p>N\u00famero de registro de la factura dentro de FACe</p> <code>documento</code> <code>str</code> <p>Documento de la cesi\u00f3n en base64</p> <code>nombre</code> <code>str</code> <p>Nombre del documento</p> <code>mime</code> <code>str</code> <p>Formato del documento</p>"},{"location":"lib/api/objects/#aapp2face.lib.objects.DocumentoCesion.guardar","title":"<code>guardar(path=None, force=False)</code>","text":"<p>Crea un archivo con el documento de la cesi\u00f3n.</p> <p>Parameters:</p> Name Type Description Default <code>path</code> <code>str, optional</code> <p>Ruta donde se guardar\u00e1 el documento decodificado</p> <code>None</code> <code>force</code> <code>bool, optional</code> <p>Sobrescribe el archivo si existe. En caso contrario lanza una excepci\u00f3n. Por defecto False</p> <code>False</code>"},{"location":"lib/api/objects/#aapp2face.lib.objects.GestionarCesion","title":"<code>GestionarCesion</code>  <code>dataclass</code>","text":"<p>Clase para respuesta FACe al gestionar una cesi\u00f3n de cr\u00e9dito.</p> <p>Attributes:</p> Name Type Description <code>numero_registro</code> <code>str</code> <p>N\u00famero de registro de la factura dentro de FACe</p> <code>codigo</code> <code>str</code> <p>Identificador del estado de la cesi\u00f3n</p> <code>comentario</code> <code>str</code> <p>Comentario asociado al estado de la cesi\u00f3n de cr\u00e9dito</p>"},{"location":"lib/api/objects/#aapp2face.lib.objects.NotificaFactura","title":"<code>NotificaFactura</code>  <code>dataclass</code>","text":"<p>Clase para respuesta FACe al notificar una factura recibida en otro PGEFe.</p> <p>Attributes:</p> Name Type Description <code>numero_registro</code> <code>str</code> <p>N\u00famero de registro de la factura dentro de FACe</p> <code>fecha_hora_registro</code> <code>str</code> <p>Fecha de registro en el REC</p>"},{"location":"lib/api/objects/#aapp2face.lib.objects.DatosPersonales","title":"<code>DatosPersonales</code>  <code>dataclass</code>","text":"<p>Clase para petici\u00f3n FACe al notificar una factura no electr\u00f3nica.</p> <p>Attributes:</p> Name Type Description <code>tipo</code> <code>str</code> <p>Tipo de persona F\u00edsica o Jur\u00eddica. Valores posibles (\"F\", \"J\")</p> <code>nombre_razon_social</code> <code>str</code> <p>Nombre de la persona f\u00edsica o raz\u00f3n social</p> <code>apellido1</code> <code>str</code> <p>Apellido 1 de la persona jur\u00eddica si procede</p> <code>apellido2</code> <code>str</code> <p>Apellido 2 de la persona jur\u00eddica si procede</p> <code>documento_nacional</code> <code>str</code> <p>DNI de la persona f\u00edsica o jur\u00eddica</p>"}]}